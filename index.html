<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlackJack Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            width: 100%;
        }

        .welcome-screen {
            background: white;
            border-radius: 20px;
            padding: 50px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 700px;
            margin: 0 auto;
        }

        .welcome-screen.hidden {
            display: none;
        }

        .dealer-setup {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .dealer-setup h3 {
            color: #0f2027;
            margin-bottom: 20px;
        }

        .avatar-upload {
            margin: 20px 0;
        }

        .avatar-preview {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #FFD700;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 3em;
            overflow: hidden;
            position: relative;
        }

        .avatar-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            margin: 10px 0;
        }

        .file-input-wrapper input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .dealer-name-input {
            padding: 15px;
            font-size: 1.2em;
            border: 2px solid #0f2027;
            border-radius: 10px;
            width: 100%;
            max-width: 300px;
            text-align: center;
            margin: 15px auto;
            display: block;
        }

        h1 {
            color: #0f2027;
            font-size: 3em;
            margin-bottom: 20px;
        }

        .capital-selector {
            margin: 40px 0;
        }

        .capital-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .capital-option {
            padding: 20px;
            border: 3px solid #0f2027;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            font-size: 1.3em;
            font-weight: bold;
            color: #0f2027;
        }

        .capital-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(15, 32, 39, 0.3);
        }

        .capital-option.selected {
            background: linear-gradient(135deg, #0f2027 0%, #2c5364 100%);
            color: white;
        }

        .game-screen {
            display: none;
        }

        .game-screen.active {
            display: block;
        }

        .game-header {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .balance-display {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.5em;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(17, 153, 142, 0.4);
        }

        .stats {
            display: flex;
            gap: 20px;
        }

        .stat-item {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
        }

        .table {
            background: linear-gradient(135deg, #1a472a 0%, #0d3321 100%);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 8px solid #8B4513;
            position: relative;
        }

        .dealer-area, .player-area {
            min-height: 200px;
            position: relative;
            margin: 20px 0;
        }

        .area-label {
            color: #FFD700;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .cards-container {
            display: flex;
            gap: 10px;
            min-height: 140px;
            align-items: center;
            flex-wrap: wrap;
        }

        .card {
            width: 90px;
            height: 130px;
            background: white;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            animation: dealCard 0.3s ease;
        }

        @keyframes dealCard {
            from {
                transform: translateY(-100px) rotate(-10deg);
                opacity: 0;
            }
            to {
                transform: translateY(0) rotate(0);
                opacity: 1;
            }
        }

        .card.red {
            color: #dc143c;
        }

        .card.black {
            color: #000;
        }

        .card-value {
            font-size: 1.8em;
            font-weight: bold;
        }

        .card-suit {
            font-size: 2em;
            text-align: center;
        }

        .card-back {
            width: 90px;
            height: 130px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: dealCard 0.3s ease;
        }

        .hand-value {
            color: #FFD700;
            font-size: 1.8em;
            font-weight: bold;
            margin-top: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .betting-area {
            background: rgba(0,0,0,0.3);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }

        .bet-input {
            padding: 15px;
            font-size: 1.5em;
            border: 3px solid #FFD700;
            border-radius: 10px;
            width: 200px;
            text-align: center;
            margin: 10px;
            font-weight: bold;
        }

        .quick-bets {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .quick-bet {
            padding: 10px 20px;
            background: rgba(255,215,0,0.2);
            border: 2px solid #FFD700;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            color: #FFD700;
            font-weight: bold;
        }

        .quick-bet:hover {
            background: #FFD700;
            color: #0f2027;
            transform: translateY(-2px);
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
        }

        .message {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            font-size: 1.3em;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .message.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .message.win {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .message.lose {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
        }

        .message.push {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .history {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin-top: 30px;
            max-height: 200px;
            overflow-y: auto;
        }

        .history-title {
            color: #FFD700;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .history-item {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-item.win {
            border-left: 4px solid #38ef7d;
        }

        .history-item.lose {
            border-left: 4px solid #f45c43;
        }

        .history-item.push {
            border-left: 4px solid #667eea;
        }

        .rules-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .rules-btn:hover {
            transform: scale(1.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-content h2 {
            color: #0f2027;
            margin-bottom: 20px;
        }

        .modal-content ul {
            text-align: left;
            line-height: 1.8;
            color: #333;
        }

        .modal-content li {
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .welcome-screen {
                padding: 30px 20px;
            }

            h1 {
                font-size: 2em;
            }

            .table {
                padding: 20px;
            }

            .card, .card-back {
                width: 70px;
                height: 100px;
            }

            .card-value {
                font-size: 1.3em;
            }

            .card-suit {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <!-- √âcran de bienvenue -->
    <div class="welcome-screen" id="welcomeScreen">
        <h1>üé∞ BlackJack Pro</h1>
        <p style="font-size: 1.2em; color: #666; margin: 20px 0;">Le jeu de cartes le plus populaire des casinos !</p>
        
        <!-- Configuration du croupier -->
        <div class="dealer-setup">
            <h3>üé© Personnalisez votre croupier</h3>
            
            <div class="avatar-preview" id="avatarPreview">
                üë§
            </div>

            <div class="avatar-upload">
                <div class="file-input-wrapper">
                    <input type="file" id="avatarInput" accept="image/*" onchange="loadAvatar(event)">
                    <label class="file-input-label">üì∑ Choisir une photo</label>
                </div>
            </div>

            <input type="text" id="dealerNameInput" class="dealer-name-input" placeholder="Nom du croupier" value="Antoine" maxlength="20">
            <p style="color: #666; font-size: 0.9em; margin-top: 10px;">Donnez un nom et une photo √† votre croupier !</p>
        </div>

        <div class="capital-selector">
            <h2 style="color: #0f2027; margin-bottom: 20px;">Choisissez votre capital de d√©part :</h2>
            <div class="capital-options">
                <div class="capital-option" onclick="selectCapital(500)">üíµ 500‚Ç¨</div>
                <div class="capital-option selected" onclick="selectCapital(1000)">üí∞ 1 000‚Ç¨</div>
                <div class="capital-option" onclick="selectCapital(2500)">üíé 2 500‚Ç¨</div>
                <div class="capital-option" onclick="selectCapital(5000)">üëë 5 000‚Ç¨</div>
                <div class="capital-option" onclick="selectCapital(10000)">üèÜ 10 000‚Ç¨</div>
            </div>
        </div>

        <button class="btn btn-primary" onclick="startGame()" style="font-size: 1.5em; padding: 20px 50px;">
            üöÄ Commencer √† jouer
        </button>
    </div>

    <!-- √âcran de jeu -->
    <div class="container game-screen" id="gameScreen">
        <div class="game-header">
            <div class="balance-display">üí∞ <span id="balance">1000</span>‚Ç¨</div>
            <div class="stats">
                <div class="stat-item">üèÜ Victoires: <span id="wins">0</span></div>
                <div class="stat-item">‚ùå D√©faites: <span id="losses">0</span></div>
                <div class="stat-item">ü§ù √âgalit√©s: <span id="pushes">0</span></div>
            </div>
        </div>

        <div class="table">
            <!-- Zone du croupier -->
            <div class="dealer-area">
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                    <div class="dealer-avatar" id="dealerAvatarGame">
                        <div style="width: 80px; height: 80px; border-radius: 50%; border: 4px solid #FFD700; box-shadow: 0 5px 15px rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-size: 2.5em; overflow: hidden;">
                            üë§
                        </div>
                    </div>
                    <div>
                        <div class="area-label" style="margin-bottom: 5px;">üé© <span id="dealerNameDisplay">Antoine</span> - Croupier</div>
                        <div class="dealer-message" id="dealerMessage" style="color: #FFD700; font-style: italic; min-height: 25px; font-size: 1.1em;">
                            "Bienvenue √† ma table ! üòé"
                        </div>
                    </div>
                </div>
                <div class="cards-container" id="dealerCards"></div>
                <div class="hand-value" id="dealerValue"></div>
            </div>

            <!-- Message -->
            <div class="message" id="message"></div>

            <!-- Zone du joueur -->
            <div class="player-area">
                <div class="area-label">üë§ Vous</div>
                <div class="cards-container" id="playerCards"></div>
                <div class="hand-value" id="playerValue"></div>
            </div>

            <!-- Zone de mise -->
            <div class="betting-area" id="bettingArea">
                <label style="color: #FFD700; font-size: 1.3em; font-weight: bold;">Votre mise :</label>
                <input type="number" id="betInput" class="bet-input" value="50" min="10" step="10">
                <div class="quick-bets">
                    <button class="quick-bet" onclick="setBet(25)">25‚Ç¨</button>
                    <button class="quick-bet" onclick="setBet(50)">50‚Ç¨</button>
                    <button class="quick-bet" onclick="setBet(100)">100‚Ç¨</button>
                    <button class="quick-bet" onclick="setBet(250)">250‚Ç¨</button>
                    <button class="quick-bet" onclick="setBet(500)">500‚Ç¨</button>
                </div>
            </div>

            <!-- Contr√¥les -->
            <div class="controls">
                <button class="btn btn-primary" id="dealBtn" onclick="dealCards()">üé¥ Distribuer</button>
                <button class="btn btn-secondary" id="hitBtn" onclick="hit()" disabled>üëÜ Carte</button>
                <button class="btn btn-warning" id="standBtn" onclick="stand()" disabled>‚úã Rester</button>
                <button class="btn btn-danger" id="doubleBtn" onclick="doubleDown()" disabled>‚ö° Doubler</button>
            </div>
        </div>

        <!-- Historique -->
        <div class="history">
            <div class="history-title">üìä Historique des parties</div>
            <div id="historyList"></div>
        </div>
    </div>

    <!-- Bouton r√®gles -->
    <button class="rules-btn" onclick="toggleRules()">‚ùì</button>

    <!-- Modal r√®gles -->
    <div class="modal" id="rulesModal" onclick="toggleRules()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2>üìú R√®gles du BlackJack</h2>
            <ul>
                <li><strong>Objectif :</strong> Avoir un total de cartes plus proche de 21 que le croupier sans d√©passer 21.</li>
                <li><strong>Valeurs des cartes :</strong>
                    <ul>
                        <li>Cartes 2-10 : valeur nominale</li>
                        <li>Valet, Dame, Roi : 10 points</li>
                        <li>As : 1 ou 11 points (selon ce qui est le plus avantageux)</li>
                    </ul>
                </li>
                <li><strong>BlackJack :</strong> As + Figure = 21 avec 2 cartes (paie 3:2)</li>
                <li><strong>Carte :</strong> Prendre une carte suppl√©mentaire</li>
                <li><strong>Rester :</strong> Conserver votre main actuelle</li>
                <li><strong>Doubler :</strong> Doubler votre mise et recevoir une seule carte</li>
                <li><strong>Le croupier :</strong> Doit tirer jusqu'√† 17 minimum</li>
                <li><strong>Victoire :</strong> Gain = mise √ó 2 (ou √ó 2.5 pour un BlackJack)</li>
            </ul>
            <button class="btn btn-primary" onclick="toggleRules()" style="margin-top: 20px;">Fermer</button>
        </div>
    </div>

    <script>
        // Variables globales
        let balance = 1000;
        let currentBet = 0;
        let wins = 0;
        let losses = 0;
        let pushes = 0;
        let deck = [];
        let playerHand = [];
        let dealerHand = [];
        let gameActive = false;
        let dealerHidden = true;
        let selectedCapital = 1000;
        let dealerName = 'Antoine';
        let dealerAvatar = null;

        const suits = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];
        const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

        // Messages d'Antoine
        const antoineMessages = {
            welcome: [
                "Bienvenue √† ma table ! üòé",
                "Pr√™t √† perdre ton argent ? üòè",
                "C'est moi le patron ici ! üé©"
            ],
            deal: [
                "C'est parti ! Bonne chance... tu vas en avoir besoin ! üòà",
                "Voyons voir ta main... int√©ressant ! ü§î",
                "Hmm, pas mal... mais j'ai mieux ! üòè",
                "Allez, montre-moi ce que tu as ! üí™"
            ],
            playerHit: [
                "Une carte de plus ? Attention au bust ! üòÖ",
                "Tu te sens chanceux aujourd'hui ? üé≤",
                "Courage, tu vas y arriver... ou pas ! üòÇ",
                "Encore une ? Tu vis dangereusement ! üî•"
            ],
            playerGoodHand: [
                "Pas mal du tout... üò¨",
                "Tu commences √† me faire peur ! üò∞",
                "Ok, tu es bon... mais je suis meilleur ! üò§",
                "Belle main, mais ce n'est pas encore fini ! üéØ"
            ],
            playerStand: [
                "Ah, tu restes ? Sage d√©cision... ou pas ! üòè",
                "Voyons si c'est suffisant ! üé¥",
                "√Ä mon tour de briller ! ‚ú®",
                "Tu crois vraiment pouvoir me battre ? üòé"
            ],
            playerBust: [
                "BUST ! Trop facile ! üòÇüòÇüòÇ",
                "Dommage ! La maison gagne toujours ! üí∞",
                "C'est √ßa quand on est trop gourmand ! ü§∑",
                "Merci pour ta contribution ! üí∏",
                "Encore rat√© ! Essaie encore ! üòú"
            ],
            dealerWin: [
                "Victoire pour la maison ! Comme d'habitude ! üëë",
                "Trop facile ! Tu veux retenter ta chance ? üí™",
                "La chance du d√©butant n'existe pas ici ! üòé",
                "Je suis imbattable aujourd'hui ! üèÜ",
                "Peut-√™tre la prochaine fois ! üòè"
            ],
            playerWin: [
                "Bien jou√©... tu as eu de la chance ! üò§",
                "Profites-en, √ßa n'arrivera pas souvent ! üòí",
                "Ok ok, tu as gagn√©... cette fois ! üôÑ",
                "Pas mal ! Mais je reviendrai plus fort ! üí™",
                "F√©licitations ! Remise √† z√©ro dans 3, 2, 1... üòà"
            ],
            playerBlackjack: [
                "BLACKJACK !? Impossible ! üò±",
                "Wow... respect ! Mais c'√©tait de la chance ! üçÄ",
                "S√©rieux ?! OK tu es bon... üòÖ",
                "Un BlackJack ! Savoure ce moment ! üéâ"
            ],
            push: [
                "√âgalit√© ! On reprend tout ! ü§ù",
                "Pas de vainqueur cette fois ! ‚öñÔ∏è",
                "Match nul ! La prochaine est pour moi ! üòè",
                "On est √† √©galit√©... pour l'instant ! üéØ"
            ],
            dealerBust: [
                "Non ! J'ai bust... üò´",
                "Argh ! Pas possible ! üò§",
                "Tu as eu de la chance l√† ! üçÄ",
                "Je me suis emball√©... bravo ! üòí"
            ],
            lowBalance: [
                "Il te reste pas grand chose ! üí∏",
                "Tu veux que je te pr√™te de l'argent ? üòÇ",
                "Bient√¥t ruin√© ! üìâ",
                "Encore quelques parties et c'est fini ! üòà"
            ]
        };

        function getRandomMessage(category) {
            const messages = antoineMessages[category];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        function setDealerMessage(text, delay = 0) {
            setTimeout(() => {
                document.getElementById('dealerMessage').textContent = `"${text}"`;
            }, delay);
        }

        function selectCapital(amount) {
            selectedCapital = amount;
            document.querySelectorAll('.capital-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.target.classList.add('selected');
        }

        function loadAvatar(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    dealerAvatar = e.target.result;
                    const preview = document.getElementById('avatarPreview');
                    preview.innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function startGame() {
            // R√©cup√©rer le nom du croupier
            const nameInput = document.getElementById('dealerNameInput').value.trim();
            dealerName = nameInput || 'Antoine';
            
            balance = selectedCapital;
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.add('active');
            
            // Afficher le nom du croupier
            document.getElementById('dealerNameDisplay').textContent = dealerName;
            
            // Afficher l'avatar du croupier dans le jeu
            const avatarGame = document.getElementById('dealerAvatarGame');
            if (dealerAvatar) {
                avatarGame.innerHTML = `<img src="${dealerAvatar}" style="width: 80px; height: 80px; border-radius: 50%; border: 4px solid #FFD700; object-fit: cover; box-shadow: 0 5px 15px rgba(0,0,0,0.5);">`;
            } else {
                avatarGame.innerHTML = `<div style="width: 80px; height: 80px; border-radius: 50%; border: 4px solid #FFD700; box-shadow: 0 5px 15px rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-size: 2.5em;">üë§</div>`;
            }
            
            updateDisplay();
            createDeck();
            setDealerMessage(getRandomMessage('welcome'));
        }

        function createDeck() {
            deck = [];
            // 6 jeux de 52 cartes (standard casino)
            for (let d = 0; d < 6; d++) {
                for (let suit of suits) {
                    for (let value of values) {
                        deck.push({ suit, value });
                    }
                }
            }
            shuffleDeck();
        }

        function shuffleDeck() {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        function getCardValue(card) {
            if (card.value === 'A') return 11;
            if (['J', 'Q', 'K'].includes(card.value)) return 10;
            return parseInt(card.value);
        }

        function calculateHandValue(hand) {
            let value = 0;
            let aces = 0;

            for (let card of hand) {
                value += getCardValue(card);
                if (card.value === 'A') aces++;
            }

            // Ajuster la valeur des As si n√©cessaire
            while (value > 21 && aces > 0) {
                value -= 10;
                aces--;
            }

            return value;
        }

        function isBlackjack(hand) {
            return hand.length === 2 && calculateHandValue(hand) === 21;
        }

        function setBet(amount) {
            if (amount <= balance) {
                document.getElementById('betInput').value = amount;
            }
        }

        function dealCards() {
            const betInput = document.getElementById('betInput');
            const bet = parseInt(betInput.value);

            if (isNaN(bet) || bet < 10) {
                showMessage('La mise minimale est de 10‚Ç¨', 'lose');
                return;
            }

            if (bet > balance) {
                showMessage('Solde insuffisant !', 'lose');
                return;
            }

            // V√©rifier s'il faut m√©langer le deck
            if (deck.length < 52) {
                createDeck();
            }

            currentBet = bet;
            balance -= bet;
            gameActive = true;
            dealerHidden = true;

            playerHand = [deck.pop(), deck.pop()];
            dealerHand = [deck.pop(), deck.pop()];

            document.getElementById('message').classList.remove('show');
            document.getElementById('bettingArea').style.display = 'none';
            document.getElementById('dealBtn').disabled = true;
            document.getElementById('hitBtn').disabled = false;
            document.getElementById('standBtn').disabled = false;
            document.getElementById('doubleBtn').disabled = playerHand.length !== 2 || balance < currentBet;

            setDealerMessage(getRandomMessage('deal'));

            updateDisplay();
            renderCards();

            // V√©rifier BlackJack imm√©diat
            if (isBlackjack(playerHand)) {
                setTimeout(() => {
                    stand();
                }, 500);
            }
        }

        function hit() {
            if (!gameActive) return;

            playerHand.push(deck.pop());
            document.getElementById('doubleBtn').disabled = true;
            
            setDealerMessage(getRandomMessage('playerHit'));
            
            renderCards();

            const playerValue = calculateHandValue(playerHand);
            
            if (playerValue >= 19 && playerValue <= 20) {
                setTimeout(() => setDealerMessage(getRandomMessage('playerGoodHand')), 600);
            }
            
            if (playerValue > 21) {
                setTimeout(() => endGame('bust'), 800);
            } else if (playerValue === 21) {
                setTimeout(() => stand(), 600);
            }
        }

        function stand() {
            if (!gameActive) return;

            gameActive = false;
            dealerHidden = false;
            document.getElementById('hitBtn').disabled = true;
            document.getElementById('standBtn').disabled = true;
            document.getElementById('doubleBtn').disabled = true;

            setDealerMessage(getRandomMessage('playerStand'));

            renderCards();

            // Le croupier tire jusqu'√† 17
            setTimeout(() => dealerPlay(), 1200);
        }

        function doubleDown() {
            if (!gameActive || balance < currentBet) return;

            balance -= currentBet;
            currentBet *= 2;
            updateDisplay();

            playerHand.push(deck.pop());
            renderCards();

            const playerValue = calculateHandValue(playerHand);
            if (playerValue > 21) {
                endGame('bust');
            } else {
                stand();
            }
        }

        function dealerPlay() {
            let dealerValue = calculateHandValue(dealerHand);

            if (dealerValue < 17) {
                dealerHand.push(deck.pop());
                renderCards();
                setTimeout(() => dealerPlay(), 800);
            } else {
                determineWinner();
            }
        }

        function determineWinner() {
            const playerValue = calculateHandValue(playerHand);
            const dealerValue = calculateHandValue(dealerHand);
            const playerBJ = isBlackjack(playerHand);
            const dealerBJ = isBlackjack(dealerHand);

            if (playerBJ && !dealerBJ) {
                setDealerMessage(getRandomMessage('playerBlackjack'), 300);
                setTimeout(() => endGame('blackjack'), 800);
            } else if (dealerValue > 21) {
                setDealerMessage(getRandomMessage('dealerBust'), 300);
                setTimeout(() => endGame('win'), 800);
            } else if (playerValue > dealerValue) {
                setDealerMessage(getRandomMessage('playerWin'), 300);
                setTimeout(() => endGame('win'), 800);
            } else if (playerValue < dealerValue) {
                setDealerMessage(getRandomMessage('dealerWin'), 300);
                setTimeout(() => endGame('lose'), 800);
            } else {
                setDealerMessage(getRandomMessage('push'), 300);
                setTimeout(() => endGame('push'), 800);
            }
        }

        function endGame(result) {
            gameActive = false;
            dealerHidden = false;

            let message = '';
            let winAmount = 0;

            switch(result) {
                case 'blackjack':
                    winAmount = Math.floor(currentBet * 2.5);
                    balance += winAmount;
                    wins++;
                    message = `üéâ BLACKJACK ! Vous gagnez ${winAmount}‚Ç¨ !`;
                    showMessage(message, 'win');
                    break;
                case 'win':
                    winAmount = currentBet * 2;
                    balance += winAmount;
                    wins++;
                    message = `‚úÖ Victoire ! Vous gagnez ${winAmount}‚Ç¨ !`;
                    showMessage(message, 'win');
                    break;
                case 'lose':
                    losses++;
                    message = `‚ùå D√©faite ! Vous perdez ${currentBet}‚Ç¨`;
                    showMessage(message, 'lose');
                    break;
                case 'bust':
                    losses++;
                    message = `üí• BUST ! Vous avez d√©pass√© 21. Vous perdez ${currentBet}‚Ç¨`;
                    showMessage(message, 'lose');
                    setDealerMessage(getRandomMessage('playerBust'), 500);
                    break;
                case 'push':
                    balance += currentBet;
                    pushes++;
                    message = `ü§ù √âgalit√© ! Mise rembours√©e`;
                    showMessage(message, 'push');
                    break;
            }

            // Message si le solde est bas
            if (balance > 0 && balance < selectedCapital * 0.3) {
                setTimeout(() => setDealerMessage(getRandomMessage('lowBalance')), 2000);
            }

            addToHistory(result, currentBet, winAmount);
            renderCards();
            updateDisplay();

            document.getElementById('dealBtn').disabled = false;
            document.getElementById('hitBtn').disabled = true;
            document.getElementById('standBtn').disabled = true;
            document.getElementById('doubleBtn').disabled = true;
            document.getElementById('bettingArea').style.display = 'block';

            if (balance <= 0) {
                setTimeout(() => {
                    if (confirm('üí∏ Vous √™tes ruin√© ! Voulez-vous recommencer ?')) {
                        balance = selectedCapital;
                        wins = 0;
                        losses = 0;
                        pushes = 0;
                        document.getElementById('historyList').innerHTML = '';
                        setDealerMessage(getRandomMessage('welcome'));
                        updateDisplay();
                    }
                }, 1500);
            }
        }

        function renderCards() {
            const dealerCardsDiv = document.getElementById('dealerCards');
            const playerCardsDiv = document.getElementById('playerCards');

            // Cartes du croupier
            dealerCardsDiv.innerHTML = '';
            dealerHand.forEach((card, index) => {
                if (index === 1 && dealerHidden) {
                    dealerCardsDiv.innerHTML += '<div class="card-back">üé¥</div>';
                } else {
                    const color = ['‚ô•Ô∏è', '‚ô¶Ô∏è'].includes(card.suit) ? 'red' : 'black';
                    dealerCardsDiv.innerHTML += `
                        <div class="card ${color}">
                            <div class="card-value">${card.value}</div>
                            <div class="card-suit">${card.suit}</div>
                            <div class="card-value" style="transform: rotate(180deg);">${card.value}</div>
                        </div>
                    `;
                }
            });

            // Cartes du joueur
            playerCardsDiv.innerHTML = '';
            playerHand.forEach(card => {
                const color = ['‚ô•Ô∏è', '‚ô¶Ô∏è'].includes(card.suit) ? 'red' : 'black';
                playerCardsDiv.innerHTML += `
                    <div class="card ${color}">
                        <div class="card-value">${card.value}</div>
                        <div class="card-suit">${card.suit}</div>
                        <div class="card-value" style="transform: rotate(180deg);">${card.value}</div>
                    </div>
                `;
            });

            // Valeurs des mains
            const playerValue = calculateHandValue(playerHand);
            document.getElementById('playerValue').textContent = `Total: ${playerValue}`;

            if (dealerHidden && dealerHand.length > 0) {
                const visibleValue = getCardValue(dealerHand[0]);
                document.getElementById('dealerValue').textContent = `Total: ${visibleValue} + ?`;
            } else if (dealerHand.length > 0) {
                const dealerValue = calculateHandValue(dealerHand);
                document.getElementById('dealerValue').textContent = `Total: ${dealerValue}`;
            }
        }

        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `message ${type} show`;
        }

        function addToHistory(result, bet, winAmount) {
            const historyList = document.getElementById('historyList');
            const item = document.createElement('div');
            
            let resultText = '';
            let resultClass = '';
            
            switch(result) {
                case 'blackjack':
                    resultText = `üéâ BLACKJACK ! +${winAmount}‚Ç¨`;
                    resultClass = 'win';
                    break;
                case 'win':
                    resultText = `‚úÖ Victoire ! +${winAmount}‚Ç¨`;
                    resultClass = 'win';
                    break;
                case 'lose':
                case 'bust':
                    resultText = `‚ùå D√©faite - ${bet}‚Ç¨`;
                    resultClass = 'lose';
                    break;
                case 'push':
                    resultText = `ü§ù √âgalit√© (${bet}‚Ç¨)`;
                    resultClass = 'push';
                    break;
            }
            
            item.className = `history-item ${resultClass}`;
            item.innerHTML = `
                <span>${resultText}</span>
                <span>Mise: ${bet}‚Ç¨</span>
            `;
            
            historyList.insertBefore(item, historyList.firstChild);
            
            // Garder seulement les 10 derni√®res parties
            while (historyList.children.length > 10) {
                historyList.removeChild(historyList.lastChild);
            }
        }

        function updateDisplay() {
            document.getElementById('balance').textContent = balance;
            document.getElementById('wins').textContent = wins;
            document.getElementById('losses').textContent = losses;
            document.getElementById('pushes').textContent = pushes;
        }

        function toggleRules() {
            const modal = document.getElementById('rulesModal');
            modal.classList.toggle('show');
        }

        // Initialisation
        updateDisplay();
    </script>
</body>
</html>
